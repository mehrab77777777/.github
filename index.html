<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุงููพุฑุงุทูุฑ ุงุฑุงู ฒฐฒท - ุจุงุฒ ุงุณุชุฑุงุชฺฺฉ</title>
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#667eea">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="ุงููพุฑุงุทูุฑ ุงุฑุงู">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="ุงููพุฑุงุทูุฑ ุงุฑุงู ฒฐฒท">
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="ุจุงุฒ ุงุณุชุฑุงุชฺฺฉ ูุฏุฑุช ุงููพุฑุงุทูุฑ ุงุฑุงู ุฏุฑ ุณุงู ฒฐฒท. ฺฉุดูุฑ ุฎูุฏ ุฑุง ุฑูุจุฑ ฺฉูุฏ!">
    <meta name="keywords" content="ุจุงุฒ ูุงุฑุณ, ุงุณุชุฑุงุชฺ, ุงุฑุงู, ุงููพุฑุงุทูุฑ, ูุฏุฑุช">
    <meta name="author" content="Iran Empire Game">
    
    <!-- Open Graph -->
    <meta property="og:title" content="ุงููพุฑุงุทูุฑ ุงุฑุงู ฒฐฒท">
    <meta property="og:description" content="ุจุงุฒ ุงุณุชุฑุงุชฺฺฉ ูุฏุฑุช ุงููพุฑุงุทูุฑ ุงุฑุงู">
    <meta property="og:image" content="./assets/icons/icon-512x512.png">
    <meta property="og:url" content="./">
    <meta property="og:type" content="website">
    
    <!-- PWA Links -->
    <link rel="manifest" href="./manifest.json">
    <link rel="icon" type="image/png" href="./assets/icons/icon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="./assets/icons/icon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="./assets/icons/icon-32x32.png">
    <link rel="apple-touch-icon" href="./assets/icons/icon-180x180.png">
    <link rel="apple-touch-icon" sizes="152x152" href="./assets/icons/icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="./assets/icons/icon-180x180.png">
    <link rel="apple-touch-icon" sizes="167x167" href="./assets/icons/icon-167x167.png">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="game-container">
        <!-- ูุฏุฑ ุจุงุฒ -->
        <header class="game-header">
            <h1>๐๏ธ ุงููพุฑุงุทูุฑ ุงุฑุงู ฒฐฒท</h1>
            <div class="header-stats">
                <div class="stat-item">
                    <span class="stat-label">ุณุงู:</span>
                    <span id="current-year">ฒฐฒท</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">ููุจุช:</span>
                    <span id="current-turn">ฑ</span>
                </div>
            </div>
        </header>

        <!-- ููู ุงุตู -->
        <nav class="main-menu">
            <button class="menu-btn active" data-tab="empire">๐ฐ ุงููพุฑุงุทูุฑ</button>
            <button class="menu-btn" data-tab="resources">๐ฐ ููุงุจุน</button>
            <button class="menu-btn" data-tab="military">โ๏ธ ูุฑู ูุธุงู</button>
            <button class="menu-btn" data-tab="diplomacy">๐ค ุฏูพููุงุณ</button>
            <button class="menu-btn" data-tab="research">๐ฌ ุชุญููุงุช</button>
            <button class="menu-btn" data-tab="world">๐ ููุดู ุฌูุงู</button>
        </nav>

        <!-- ุตูุญู ุงููพุฑุงุทูุฑ -->
        <div id="empire-tab" class="tab-content active">
            <div class="empire-overview">
                <div class="country-info">
                    <h2>๐ฎ๐ท ุงููพุฑุงุทูุฑ ุงุฑุงู</h2>
                    <div class="country-stats">
                        <div class="stat-card">
                            <div class="stat-icon">๐ฅ</div>
                            <div class="stat-info">
                                <span class="stat-value" id="population">ธต,ฐฐฐ,ฐฐฐ</span>
                                <span class="stat-name">ุฌูุนุช</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">๐</div>
                            <div class="stat-info">
                                <span class="stat-value" id="happiness">ทตูช</span>
                                <span class="stat-name">ุฑุถุงุชููุฏ</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">๐ญ</div>
                            <div class="stat-info">
                                <span class="stat-value" id="industry">ถตูช</span>
                                <span class="stat-name">ุตูุนุช</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">๐ฏ</div>
                            <div class="stat-info">
                                <span class="stat-value" id="stability">ธฐูช</span>
                                <span class="stat-name">ุซุจุงุช</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="regions-section">
                    <h3>๐บ๏ธ ุงุณุชุงูโูุง ุงููพุฑุงุทูุฑ</h3>
                    <div class="regions-grid" id="regions-list">
                        <!-- ุงู ูุณูุช ุจุง JavaScript ูพุฑ ูโุดูุฏ -->
                    </div>
                </div>
            </div>
        </div>

        <!-- ุตูุญู ููุงุจุน -->
        <div id="resources-tab" class="tab-content">
            <div class="resources-overview">
                <h2>๐ฐ ูุฏุฑุช ููุงุจุน</h2>
                <div class="resources-grid">
                    <div class="resource-card">
                        <div class="resource-icon">๐ฐ</div>
                        <div class="resource-info">
                            <span class="resource-amount" id="gold">ฑฐฐ,ฐฐฐ</span>
                            <span class="resource-name">ุทูุง</span>
                            <span class="resource-income">+ฑต,ฐฐฐ ุฏุฑ ููุจุช</span>
                        </div>
                    </div>
                    <div class="resource-card">
                        <div class="resource-icon">๐พ</div>
                        <div class="resource-info">
                            <span class="resource-amount" id="food">ธฐ,ฐฐฐ</span>
                            <span class="resource-name">ุบุฐุง</span>
                            <span class="resource-income">+ฑฒ,ฐฐฐ ุฏุฑ ููุจุช</span>
                        </div>
                    </div>
                    <div class="resource-card">
                        <div class="resource-icon">โก</div>
                        <div class="resource-info">
                            <span class="resource-amount" id="energy">ถฐ,ฐฐฐ</span>
                            <span class="resource-name">ุงูุฑฺ</span>
                            <span class="resource-income">+ธ,ฐฐฐ ุฏุฑ ููุจุช</span>
                        </div>
                    </div>
                    <div class="resource-card">
                        <div class="resource-icon">๐ญ</div>
                        <div class="resource-info">
                            <span class="resource-amount" id="production">ดต,ฐฐฐ</span>
                            <span class="resource-name">ุชููุฏ</span>
                            <span class="resource-income">+ถ,ฐฐฐ ุฏุฑ ููุจุช</span>
                        </div>
                    </div>
                </div>

                <div class="economic-actions">
                    <h3>๐๏ธ ูพุฑูฺูโูุง ุงูุชุตุงุฏ</h3>
                    <div class="projects-grid">
                        <div class="project-card">
                            <h4>๐ฆ ุณุงุฎุช ุจุงูฺฉ ูุฑฺฉุฒ</h4>
                            <p>ุฏุฑุขูุฏ ุทูุง +ฒฐูช</p>
                            <div class="project-cost">ูุฒูู: ฒฐ,ฐฐฐ ุทูุง</div>
                            <button class="project-btn" onclick="buildProject('bank')">ุณุงุฎุช</button>
                        </div>
                        <div class="project-card">
                            <h4>๐ ุชูุณุนู ฺฉุดุงูุฑุฒ</h4>
                            <p>ุชููุฏ ุบุฐุง +ณฐูช</p>
                            <div class="project-cost">ูุฒูู: ฑต,ฐฐฐ ุทูุง</div>
                            <button class="project-btn" onclick="buildProject('farm')">ุณุงุฎุช</button>
                        </div>
                        <div class="project-card">
                            <h4>โก ูุฑูฺฏุงู ุจุฑู</h4>
                            <p>ุชููุฏ ุงูุฑฺ +ฒตูช</p>
                            <div class="project-cost">ูุฒูู: ฒต,ฐฐฐ ุทูุง</div>
                            <button class="project-btn" onclick="buildProject('powerplant')">ุณุงุฎุช</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ุตูุญู ูุฑู ูุธุงู -->
        <div id="military-tab" class="tab-content">
            <div class="military-overview">
                <h2>โ๏ธ ูุฑู ูุธุงู</h2>
                <div class="military-stats">
                    <div class="military-card">
                        <div class="military-icon">๐ช</div>
                        <div class="military-info">
                            <span class="military-amount" id="infantry">ตฐ,ฐฐฐ</span>
                            <span class="military-name">ูพุงุฏู ูุธุงู</span>
                        </div>
                    </div>
                    <div class="military-card">
                        <div class="military-icon">๐</div>
                        <div class="military-info">
                            <span class="military-amount" id="air-force">ฒตฐ</span>
                            <span class="military-name">ูุฑู ููุง</span>
                        </div>
                    </div>
                    <div class="military-card">
                        <div class="military-icon">๐ข</div>
                        <div class="military-info">
                            <span class="military-amount" id="navy">ฑตฐ</span>
                            <span class="military-name">ูุฑู ุฏุฑุง</span>
                        </div>
                    </div>
                    <div class="military-card">
                        <div class="military-icon">๐</div>
                        <div class="military-info">
                            <span class="military-amount" id="missiles">ฑฐฐ</span>
                            <span class="military-name">ููุดฺฉโูุง</span>
                        </div>
                    </div>
                </div>

                <div class="recruitment-section">
                    <h3>๐๏ธ ุงุณุชุฎุฏุงู ูุฑู</h3>
                    <div class="recruitment-grid">
                        <div class="recruitment-card">
                            <h4>๐ช ุขููุฒุด ุณุฑุจุงุฒ</h4>
                            <p>+ฑ,ฐฐฐ ูพุงุฏู ูุธุงู</p>
                            <div class="recruitment-cost">ูุฒูู: ต,ฐฐฐ ุทูุง</div>
                            <button class="recruitment-btn" onclick="recruitUnit('infantry')">ุงุณุชุฎุฏุงู</button>
                        </div>
                        <div class="recruitment-card">
                            <h4>โ๏ธ ุณุงุฎุช ุฌูฺฏูุฏู</h4>
                            <p>+ฑฐ ุฌูฺฏูุฏู</p>
                            <div class="recruitment-cost">ูุฒูู: ฒฐ,ฐฐฐ ุทูุง</div>
                            <button class="recruitment-btn" onclick="recruitUnit('airforce')">ุณุงุฎุช</button>
                        </div>
                        <div class="recruitment-card">
                            <h4>๐ข ุณุงุฎุช ูุงูุดฺฉู</h4>
                            <p>+ต ูุงูุดฺฉู</p>
                            <div class="recruitment-cost">ูุฒูู: ณฐ,ฐฐฐ ุทูุง</div>
                            <button class="recruitment-btn" onclick="recruitUnit('navy')">ุณุงุฎุช</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ุตูุญู ุฏูพููุงุณ -->
        <div id="diplomacy-tab" class="tab-content">
            <div class="diplomacy-overview">
                <h2>๐ค ุฑูุงุจุท ุฏูพููุงุชฺฉ</h2>
                <div class="countries-list">
                    <div class="country-relation">
                        <div class="country-flag">๐บ๐ธ</div>
                        <div class="country-name">ุงุงูุงุช ูุชุญุฏู</div>
                        <div class="relation-status neutral">ุจโุทุฑู</div>
                        <div class="diplomacy-actions">
                            <button onclick="changeDiplomacy('usa', 'alliance')">ุงุชุญุงุฏ</button>
                            <button onclick="changeDiplomacy('usa', 'trade')">ุชุฌุงุฑุช</button>
                            <button onclick="changeDiplomacy('usa', 'hostility')">ุฎุตููุช</button>
                        </div>
                    </div>
                    <div class="country-relation">
                        <div class="country-flag">๐ท๐บ</div>
                        <div class="country-name">ุฑูุณู</div>
                        <div class="relation-status friendly">ุฏูุณุชุงูู</div>
                        <div class="diplomacy-actions">
                            <button onclick="changeDiplomacy('russia', 'alliance')">ุงุชุญุงุฏ</button>
                            <button onclick="changeDiplomacy('russia', 'trade')">ุชุฌุงุฑุช</button>
                            <button onclick="changeDiplomacy('russia', 'hostility')">ุฎุตููุช</button>
                        </div>
                    </div>
                    <div class="country-relation">
                        <div class="country-flag">๐จ๐ณ</div>
                        <div class="country-name">ฺู</div>
                        <div class="relation-status friendly">ุฏูุณุชุงูู</div>
                        <div class="diplomacy-actions">
                            <button onclick="changeDiplomacy('china', 'alliance')">ุงุชุญุงุฏ</button>
                            <button onclick="changeDiplomacy('china', 'trade')">ุชุฌุงุฑุช</button>
                            <button onclick="changeDiplomacy('china', 'hostility')">ุฎุตููุช</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ุตูุญู ุชุญููุงุช -->
        <div id="research-tab" class="tab-content">
            <div class="research-overview">
                <h2>๐ฌ ุชุญููุงุช ู ููุงูุฑ</h2>
                <div class="research-points">
                    <div class="research-stat">
                        <span class="research-icon">๐งช</span>
                        <span>ุงูุชุงุฒ ุชุญูู: <span id="research-points">ฒต,ฐฐฐ</span></span>
                    </div>
                </div>
                <div class="research-tree">
                    <div class="research-category">
                        <h3>๐ญ ููุงูุฑ ุตูุนุช</h3>
                        <div class="research-item">
                            <h4>๐ค ุงุชููุงุณูู ุตูุนุช</h4>
                            <p>ุชููุฏ +ฒฐูช</p>
                            <div class="research-cost">ูุฒูู: ฑฐ,ฐฐฐ ุงูุชุงุฒ</div>
                            <button onclick="research('automation')">ุชุญูู</button>
                        </div>
                    </div>
                    <div class="research-category">
                        <h3>โ๏ธ ููุงูุฑ ูุธุงู</h3>
                        <div class="research-item">
                            <h4>๐ ููุดฺฉโูุง ููุดููุฏ</h4>
                            <p>ูุฏุฑุช ูุธุงู +ณฐูช</p>
                            <div class="research-cost">ูุฒูู: ฑต,ฐฐฐ ุงูุชุงุฒ</div>
                            <button onclick="research('smart-missiles')">ุชุญูู</button>
                        </div>
                    </div>
                    <div class="research-category">
                        <h3>๐ฑ ููุงูุฑ ุฒุณุชโูุญุท</h3>
                        <div class="research-item">
                            <h4>โ๏ธ ุงูุฑฺ ุฎูุฑุดุฏ</h4>
                            <p>ุชููุฏ ุงูุฑฺ +ฒตูช</p>
                            <div class="research-cost">ูุฒูู: ธ,ฐฐฐ ุงูุชุงุฒ</div>
                            <button onclick="research('solar-energy')">ุชุญูู</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ุตูุญู ููุดู ุฌูุงู -->
        <div id="world-tab" class="tab-content">
            <div class="world-overview">
                <h2>๐ ููุดู ุฌูุงู</h2>
                <div class="world-map">
                    <div class="region iran" onclick="selectRegion('iran')">
                        <span class="region-name">ุงุฑุงู</span>
                        <span class="region-power">ูุฏุฑุช: ธต</span>
                    </div>
                    <div class="region usa" onclick="selectRegion('usa')">
                        <span class="region-name">ุขูุฑฺฉุง</span>
                        <span class="region-power">ูุฏุฑุช: นต</span>
                    </div>
                    <div class="region russia" onclick="selectRegion('russia')">
                        <span class="region-name">ุฑูุณู</span>
                        <span class="region-power">ูุฏุฑุช: ธฐ</span>
                    </div>
                    <div class="region china" onclick="selectRegion('china')">
                        <span class="region-name">ฺู</span>
                        <span class="region-power">ูุฏุฑุช: นฐ</span>
                    </div>
                </div>
                <div class="world-events">
                    <h3>๐ฐ ุงุฎุจุงุฑ ุฌูุงู</h3>
                    <div id="world-news">
                        <div class="news-item">
                            <span class="news-date">ุณุงู ฒฐฒท</span>
                            <span class="news-text">ุชูุดโูุง ุงูุชุตุงุฏ ุฏุฑ ููุทูู ุงูุฒุงุด ุงูุชู ุงุณุช</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ฺฉูุชุฑูโูุง ุจุงุฒ -->
        <div class="game-controls">
            <button class="next-turn-btn" onclick="nextTurn()">๐ ููุจุช ุจุนุฏ</button>
            <button class="save-game-btn" onclick="saveGame()">๐พ ุฐุฎุฑู ุจุงุฒ</button>
            <button class="settings-btn" onclick="openSettings()">โ๏ธ ุชูุธูุงุช</button>
        </div>

        <!-- ุฑูุฏุงุฏูุง ู ูพุงูโูุง -->
        <div id="event-modal" class="modal hidden">
            <div class="modal-content">
                <h3 id="event-title">ุฑูุฏุงุฏ ุฌุฏุฏ</h3>
                <p id="event-description">ุชูุถุญุงุช ุฑูุฏุงุฏ</p>
                <div class="event-choices">
                    <button id="choice-1" onclick="handleEventChoice(1)">ฺฏุฒูู ฑ</button>
                    <button id="choice-2" onclick="handleEventChoice(2)">ฺฏุฒูู ฒ</button>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    
    <!-- PWA Registration -->
    <script>
        // ุซุจุช Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('./sw.js')
                    .then(function(registration) {
                        console.log('Service Worker ุซุจุช ุดุฏ:', registration.scope);
                        
                        // ุจุฑุฑุณ ุขูพุฏุช
                        registration.addEventListener('updatefound', () => {
                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    // ููุงุด ูพุงู ุขูพุฏุช
                                    showUpdateNotification();
                                }
                            });
                        });
                    })
                    .catch(function(error) {
                        console.log('ุฎุทุง ุฏุฑ ุซุจุช Service Worker:', error);
                    });
            });
        }

        // ููุงุด ูพุงู ูุตุจ PWA
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            showInstallPromotion();
        });

        function showInstallPromotion() {
            // ููุงุด ุฏฺฉูู ูุตุจ
            setTimeout(() => {
                if (deferredPrompt && !window.matchMedia('(display-mode: standalone)').matches) {
                    const installBanner = document.createElement('div');
                    installBanner.className = 'install-banner';
                    installBanner.innerHTML = `
                        <div class="install-content">
                            <span>๐ฑ ุงููพุฑุงุทูุฑ ุงุฑุงู ุฑุง ุฑู ฺฏูุด ุฎูุฏ ูุตุจ ฺฉูุฏ!</span>
                            <button onclick="installApp()" class="install-btn">ูุตุจ</button>
                            <button onclick="dismissInstall()" class="dismiss-btn">ร</button>
                        </div>
                    `;
                    document.body.appendChild(installBanner);
                }
            }, 5000);
        }

        function installApp() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('ฺฉุงุฑุจุฑ ุงูพูฺฉุดู ุฑุง ูุตุจ ฺฉุฑุฏ');
                    }
                    deferredPrompt = null;
                    dismissInstall();
                });
            }
        }

        function dismissInstall() {
            const banner = document.querySelector('.install-banner');
            if (banner) {
                banner.remove();
            }
        }

        function showUpdateNotification() {
            const updateNotification = document.createElement('div');
            updateNotification.className = 'update-notification';
            updateNotification.innerHTML = `
                <div class="update-content">
                    <span>๐ ูุณุฎู ุฌุฏุฏ ุฏุฑ ุฏุณุชุฑุณ ุงุณุช!</span>
                    <button onclick="updateApp()" class="update-btn">ุจุฑูุฒุฑุณุงู</button>
                    <button onclick="dismissUpdate()" class="dismiss-btn">ุจุนุฏุงู</button>
                </div>
            `;
            document.body.appendChild(updateNotification);
        }

        function updateApp() {
            if (navigator.serviceWorker.controller) {
                navigator.serviceWorker.controller.postMessage({type: 'SKIP_WAITING'});
                window.location.reload();
            }
        }

        function dismissUpdate() {
            const notification = document.querySelector('.update-notification');
            if (notification) {
                notification.remove();
            }
        }

        // ุชุดุฎุต ุญุงูุช PWA
        window.addEventListener('DOMContentLoaded', () => {
            if (window.matchMedia('(display-mode: standalone)').matches) {
                console.log('ุฏุฑ ุญุงูุช PWA ุงุฌุฑุง ูโุดูุฏ');
                document.body.classList.add('pwa-mode');
            }
        });

        // ูุฏุฑุช ุงุชุตุงู ุงูุชุฑูุช
        window.addEventListener('online', () => {
            showNotification('๐ ุงุชุตุงู ุงูุชุฑูุช ุจุฑูุฑุงุฑ ุดุฏ', 'success');
        });

        window.addEventListener('offline', () => {
            showNotification('๐ต ุฏุฑ ุญุงูุช ุขููุงู ูุณุชุฏ', 'warning');
        });
    </script>

    <!-- Custom CSS for PWA elements -->
    <style>
        .install-banner, .update-notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--gradient-primary);
            color: white;
            padding: 15px 25px;
            border-radius: 15px;
            box-shadow: var(--shadow);
            z-index: 3000;
            animation: slideDown 0.5s ease-out;
        }

        .install-content, .update-content {
            display: flex;
            align-items: center;
            gap: 15px;
            font-weight: 600;
        }

        .install-btn, .update-btn {
            background: white;
            color: var(--primary-color);
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .install-btn:hover, .update-btn:hover {
            transform: scale(1.05);
        }

        .dismiss-btn {
            background: transparent;
            color: white;
            border: 1px solid white;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 18px;
            line-height: 1;
        }

        .pwa-mode .game-controls {
            bottom: 30px;
        }

        @media (max-width: 480px) {
            .install-banner, .update-notification {
                left: 10px;
                right: 10px;
                transform: none;
            }
            
            .install-content, .update-content {
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }
        }
    </style>
</body>
</html>